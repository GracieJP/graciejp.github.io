{% extends "base.html" %}

{% macro format(info) -%}
  {% if info is mapping -%}
    {%- if info.text -%}
      {%- if info.details -%}
        <details {{ 'open' if info.open is true }}>
          <summary>{{ info.text }}</summary>
          {{ format(info.details) }}
        </details>
      {%- else -%}
        {{ info.text }}
      {%- endif -%}
    {%- endif -%}
    {% if info.bullets -%}
      <ul>
        {% for bullet in info.bullets -%}
          {% if bullet.details -%}
            <li class="details">{{ format(bullet) }}</li>
          {% else -%}
            <li>{{ format(bullet) }}</li>
          {% endif -%}
        {% endfor -%}
      </ul>
    {% endif -%}
  {% elif info is string -%}
    {{ info }}
  {%- else -%}
    <ul>
      {%- for datum in info -%}
        {% if datum.details -%}
          <li class="details">{{ format(datum) }}</li>
        {% else -%}
          <li>{{ format(datum) }}</li>
        {% endif -%}
      {%- endfor -%}
    </ul>
  {%- endif -%}
{% endmacro -%}

{% block content %}
<div class="title">
  <h1>{{ page.meta.name }}</h1>
  <h2>{{ page.meta.position }}</h2>
</div>
<p>
{% for section, data in page.meta.sections.items() -%}
  <h2>{{ section }}</h2>
  {% for item in data -%}
    <div class="title">
      {% if item.title or item.company or item.school -%}
        <h3>{{ item.title or item.company or item.school }}</h3>
      {% endif -%}
      {% if item.date -%}
        <h5>{{ item.date }}</h5>
      {% endif -%}
    </div>
    <div class="title">
      {% if item.subtitle or item.position or item.degree -%}
        <h4>{{ item.subtitle or item.position or item.degree }}</h4>
      {% endif -%}
      {% if item.gpa -%}
        <h4>GPA: {{ item.gpa }}</h4>
      {% elif item.location -%}
        <h5>{{ item.location }}</h5>
      {% endif -%}
    </div>
    {% if item.data -%}
      <div class="data">
      {# Useful for plaintext or raw HTML #}
        {{ format(item.data) }}
      </div>
    {% endif -%}
  {% endfor -%}
  <p>
{% endfor -%}

{% endblock -%}
